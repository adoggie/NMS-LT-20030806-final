CREATE VIEW dbo.STATUSVIEW
AS
SELECT T2.*
FROM dbo.STATUS T2 INNER JOIN
          (SELECT REPEATER_ID, MAX(OPTTIME) AS QT
         FROM STATUS
         GROUP BY REPEATER_ID) T3 ON T2.REPEATER_ID = T3.REPEATER_ID AND 
      T2.OPTTIME = T3.QT



/****** Object:  Stored Procedure dbo.GetGUID    Script Date: 02-8-7 9:47:55 ******/
CREATE PROCEDURE GetGUID
@guidno numeric OUTPUT
AS
BEGIN TRAN
UPDATE GUIDTB WITH( TABLOCKX HOLDLOCK) SET GUIDNO=GUIDNO+1 	
DECLARE TEMP_CURSOR SCROLL CURSOR FOR
	SELECT GUIDNO  FROM GUIDTB
OPEN TEMP_CURSOR
FETCH FIRST FROM TEMP_CURSOR INTO @GUIDNO
CLOSE TEMP_CURSOR
DEALLOCATE  TEMP_CURSOR
COMMIT TRAN
GO
